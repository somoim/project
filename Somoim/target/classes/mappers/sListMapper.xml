<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.mapper.sListMapper">

	<select id="slist_list" resultType="sListVO">
		<![CDATA[
		select * from slist 
		 where ATTEND_DATE = (
		 	select min(ATTEND_DATE) from (
		 		select * from sList 
		 		 where attend_date between (select replace(to_char(sysdate, 'yyyy/mm/ddhh24mi'), '/','') from dual) 
		 								and (select max(to_number(attend_date)) from sList) 
		 			and cno=#{cno} ) )
		 	and cno=#{cno}
		 ]]>
	</select>
	
	<select id="slist_tab_list" resultType="sListVO">
		select * from slist where cno = #{cno} order by sl_no
	</select>
	
	<update id="update_s_join_cnt">
		update slist set s_join_cnt = s_join_cnt + 1 where sl_no = #{sl_no}
	</update>
	
	<insert id="join_sList_insert">
		insert into status (sno,cno,sl_no,mid) values(seq_sno.nextval,#{cno},#{sl_no},#{mid})
	</insert>
	
	<select id="join_sList_select" resultType="StatusVO">
		select * from status where sl_no = #{sl_no} order by sl_no
	</select>
	
	<select id="join_sList_member" resultType="StatusVO">
		select sl_no,mid from status where cno = #{cno} and sl_no is not null order by sl_no
	</select>
</mapper>